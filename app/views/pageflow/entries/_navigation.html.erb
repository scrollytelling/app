<nav id="polka-nav">
  <ul>
    <% entry.pages.displayed_in_navigation.each do |page| %>
      <li><a href="#<%= page.perma_id %>"><span></span></a><div class="polka-tooltip"><%= page.configuration["title"] %></div></li>
    <% end %>
  </ul>
</div>

<script>
pageflow.Counter = {
  polkaNav: $('#polka-nav'),

  setActive: function(page) {
    $(page).hasClass('invert') ? this.polkaNav.addClass('invert') : this.polkaNav.removeClass('invert');
    this.polkaNav.find('a').removeClass('active');
    this.polkaNav.find('a[href="#'+page.id+'"]').addClass('active');
  },

  updateActive: function(page) {
    this.setActive(page.element[0]);
  },

  init: function() {
    // Init active dot
    this.setActive(pageflow.atmo.slideshow.currentPage()[0]);

    // Listen to page changes
    pageflow.events.on('page:change', this.updateActive.bind(this));
  }
}

pageflow.ready.then(function() {
  pageflow.Counter.init();
});
</script>
