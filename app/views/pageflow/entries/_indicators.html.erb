<% if theme.has_scroll_back_indicator? %>
  <div class="scroll_back_indicator scroll_indicator indicator" data-direction="up">
    <%= t('pageflow.public.scroll_back_indicator') %>
  </div>
<% end %>

<div class="scroll_next_indicator scroll_indicator indicator" data-direction="down">
  <%= t('pageflow.public.scroll_indicator', default: "Scroll om door te gaan") %>
</div>

<div class="hidden_text_indicator indicator">
  <%= t('pageflow.public.swipe_indicator') %>
</div>

<ul class="sharing">
  <li><a href="#" id="share-tw"><%= image_tag "twitter.png", alt: "Share on Twitter", title: "Share on Twitter" %></a></li>
  <li><a href="#" id="share-fb"><%= image_tag "facebook.png", alt: "Share on Facebook", title: "Share on Facebook" %></a></li>
</ul>

<ul class="options">
  <li><a href="#" id="back-to-top"><%= image_tag "arrow_up.png", alt: "Back to top", title: "Back to top" %></a></li>
  <li><a href="#" id="mute-audio"><%= image_tag "audio_on.png", alt: "Mute", title: "Mute" %></a></li>
  <li><a href="#" id="play-audio" style="display: none;"><%= image_tag "audio_off.png", alt: "Mute", title: "Mute" %></a></li>
</ul>

<div id="st-counter">
  <ul>
  </ul>
</div>

<script>
pageflow.Counter = {
  placeHtml: $('#st-counter ul'),

  dots: function(pages) {
    return pages.map(function(page) {
      return $('<li><a href="#'+page.perma_id+'"><span></span></a><div class="st-tooltip">'+page.configuration.title+'</div></li>');
    });
  },

  setActive: function(id) {
    this.placeHtml.find('a').removeClass('active');
    this.placeHtml.find('a[href="#'+id+'"]').addClass('active');
  },

  updateActive: function(page) {
    this.setActive(page.element[0].id);
  },

  init: function() {
    this.placeHtml.html(this.dots(pageflow.pages));

    // Init active dot
    this.setActive(pageflow.atmo.slideshow.currentPage()[0].id);

    // Listen to page changes
    pageflow.events.on('page:change', this.updateActive.bind(this));
  }
}

pageflow.ready.then(function() {
  pageflow.Counter.init();
});
</script>

<script>
  $('#share-fb').on('click', function(event) {
    event.preventDefault();
    var fbSharer = window.open(
      "https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(location.href.replace(location.hash,"")),
      "Facebook",
      "width=600,height=300"
    );
  });

  $('#share-tw').on('click', function(event) {
    event.preventDefault();
    var twSharer = window.open(
      "https://twitter.com/intent/tweet?text=<%= u strip_tags(@entry.summary) %>&amp;via=Scrollytellio&amp;url="+encodeURIComponent(location.href.replace(location.hash,"")),
      "Twitter",
      "width=600,height=260"
    )
  });

  $('#mute-audio').on('click', function(event) {
    event.preventDefault();
    pageflow.settings.set('volume', 0);
    $('#mute-audio').css({display: "none"});
    $('#play-audio').css({display: "inline"});
  });

  $('#play-audio').on('click', function(event) {
    event.preventDefault();
    pageflow.settings.set('volume', 1);
    $('#mute-audio').css({display: "inline"});
    $('#play-audio').css({display: "none"});
  });

  $('#back-to-top').on('click', function(event) {
    event.preventDefault();
    location.hash = "#" + pageflow.pages[0].perma_id;
  });
</script>
